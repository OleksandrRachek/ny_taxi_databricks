resources:
  jobs:
    nyctaxi_job:
      name: nyctaxi_job
      tasks:
        - task_key: 00_ingest_fhv_trips
          notebook_task:
            notebook_path: transformations/notebooks/00_landing/ingest_fhv_trip
            source: GIT
        - task_key: 00_ingest_green_trips
          notebook_task:
            notebook_path: transformations/notebooks/00_landing/ingest_green_trip
            source: GIT
        - task_key: 00_ingest_hv_fhv_trips
          notebook_task:
            notebook_path: transformations/notebooks/00_landing/ingest_hv_fhv_trip
            source: GIT
        - task_key: 00_ingest_lookup
          notebook_task:
            notebook_path: transformations/notebooks/00_landing /ingest_lookup
            source: GIT
        - task_key: 00_ingest_yellow_trips
          notebook_task:
            notebook_path: transformations/notebooks/00_landing/ingest_yellow_trip
            source: GIT
        - task_key: continue_downstream_fhv_trips
          depends_on:
            - task_key: 00_ingest_fhv_trips
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.00_ingest_fhv_trips.values.continue_downstream}}"
            right: yes
        - task_key: 01_fhv_trips_raw
          depends_on:
            - task_key: continue_downstream_fhv_trips
              outcome: "true"
          notebook_task:
            notebook_path: transformations/notebooks/01_bronze/fhv_trips_raw
            source: GIT
        - task_key: 02_fhv_trips_cleansed
          depends_on:
            - task_key: 01_fhv_trips_raw
          run_if: ALL_DONE
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/1_fhv_trips_cleansed
            source: GIT
        - task_key: continue_downstream_green_trips
          depends_on:
            - task_key: 00_ingest_green_trips
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.00_ingest_green_trips.values.continue_downstream}}"
            right: yes
        - task_key: 01_green_trips_raw
          depends_on:
            - task_key: continue_downstream_green_trips
              outcome: "true"
          notebook_task:
            notebook_path: transformations/notebooks/01_bronze/green_trips_raw
            source: GIT
        - task_key: 02_green_trips_cleansed
          depends_on:
            - task_key: 01_green_trips_raw
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/1_green_trips_cleansed
            source: GIT
        - task_key: continue_downstream_hv_fhv_trips
          depends_on:
            - task_key: 00_ingest_hv_fhv_trips
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.00_ingest_hv_fhv_trips.values.continue_downstream}}"
            right: yes
        - task_key: 01_hv_fhv_trips_raw
          depends_on:
            - task_key: continue_downstream_hv_fhv_trips
              outcome: "true"
          notebook_task:
            notebook_path: transformations/notebooks/01_bronze/hv_fhv_trips_raw
            source: GIT
        - task_key: 02_hv_fhv_trips_cleansed
          depends_on:
            - task_key: 01_hv_fhv_trips_raw
          run_if: ALL_DONE
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/1_hv_fhv_trips_cleansed
            source: GIT
        - task_key: continue_downstream_lookup
          depends_on:
            - task_key: 00_ingest_lookup
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.00_ingest_lookup.values.continue_downstream}}"
            right: yes
        - task_key: 02_taxi_zone_lookup
          depends_on:
            - task_key: continue_downstream_lookup
              outcome: "true"
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/0_taxi_zone_lookup
            source: GIT
        - task_key: 02_fhv_trips_enriched
          depends_on:
            - task_key: 02_taxi_zone_lookup
            - task_key: 02_fhv_trips_cleansed
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/3_fhv_trips_enriched
            source: GIT
        - task_key: 02_hv_fhv_trips_enriched
          depends_on:
            - task_key: 02_taxi_zone_lookup
            - task_key: 02_hv_fhv_trips_cleansed
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/3_hv_fhv_trips_enriched
            source: GIT
        - task_key: continue_downstream_yellow_trips
          depends_on:
            - task_key: 00_ingest_yellow_trips
          condition_task:
            op: EQUAL_TO
            left: "{{tasks.00_ingest_yellow_trips.values.continue_downstream}}"
            right: yes
        - task_key: 01_yellow_trips_raw
          depends_on:
            - task_key: continue_downstream_yellow_trips
              outcome: "true"
          notebook_task:
            notebook_path: transformations/notebooks/01_bronze/yellow_trips_raw
            source: GIT
        - task_key: 02_yellow_trips_cleansed
          depends_on:
            - task_key: 01_yellow_trips_raw
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/1_yellow_trips_cleansed
            source: GIT
        - task_key: 02_green_and_yellow_trips_cleansed
          depends_on:
            - task_key: 02_green_trips_cleansed
            - task_key: 02_yellow_trips_cleansed
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/2_green_and_yellow_trips_cleansed
            source: GIT
        - task_key: 02_green_and_yellow_trips_enriched
          depends_on:
            - task_key: 02_taxi_zone_lookup
            - task_key: 02_green_and_yellow_trips_cleansed
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/3_green_and_yellow_trips_enriched
            source: GIT
        - task_key: 02_factTrips
          depends_on:
            - task_key: 02_fhv_trips_enriched
            - task_key: 02_hv_fhv_trips_enriched
            - task_key: 02_green_and_yellow_trips_enriched
          run_if: NONE_FAILED
          notebook_task:
            notebook_path: transformations/notebooks/02_silver/4_factTrips
            source: GIT
        - task_key: 03_daily_fraud_detection
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/6_daily_fraud_detection
            source: GIT
        - task_key: 03_daily_trip_summary_per_pu_zone
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/3_daily_trip_summary_per_pu_zone
            source: GIT
        - task_key: 03_daily_trip_summary_per_taxi_type
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/2_daily_trip_summary_per_taxi_type
            source: GIT
        - task_key: 03_daily_trips_summary
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/1_daily_trip_summary
            source: GIT
        - task_key: 03_hourly_trip_summary_per_do_zone
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/5_hourly_trip_summary_per_do_zone
            source: GIT
        - task_key: 03_hourly_trip_summary_per_pu_zone
          depends_on:
            - task_key: 02_factTrips
          notebook_task:
            notebook_path: transformations/notebooks/03_gold/4_hourly_trip_summary_per_pu_zone
            source: GIT
        - task_key: 04_yellow_trips_export
          depends_on:
            - task_key: 02_green_and_yellow_trips_enriched
          notebook_task:
            notebook_path: transformations/notebooks /04_export/yellow_trips_airport
            source: GIT
      git_source:
        git_url: https://github.com/OleksandrRachek/databricks_project.git
        git_provider: gitHub
        git_branch: main
      queue:
        enabled: true
      performance_target: PERFORMANCE_OPTIMIZED
